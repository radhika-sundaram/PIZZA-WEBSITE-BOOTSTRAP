"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73681],{3399:(e,t,r)=>{r.d(t,{h:()=>o});var a=r(30500),i=r(71335),n=r(59658),s=r(2450),l=r(60325),u=e=>{var{acc:t,totalCostOfItems:r,amountRemaining:i,totalAmount:n,bypassLowBalance:s=!1}=e;return s||(r>i&&(t.hasInsufficientSubscriptionCredits=!0,t.hasLowDebitableBalance=!1,t.insufficientAmount=r-i),!t.hasInsufficientSubscriptionCredits&&i<=n*a.O7&&(t.hasLowDebitableBalance=!0)),t},o=e=>{var{items:t,subscriptions:r,subscription:o,hasWrapperSubscription:c=!0}=e;if(t&&t.length){var d={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:a.EV};return t.reduce((e,t)=>{var d,{licenseId:v,price:m}=t,p=(0,n.W)({assets:[t]}),f=o||(0,l.A)({subscriptions:null==(d=(0,s.s)({assetType:p,subscriptions:r}))?void 0:d.subscriptions,licenseName:v,assetType:p})||{},{totalAmount:h,amountRemaining:y,amountType:_,amount:b}=(0,i.hY)(f);e.amountType=_;var g=parseFloat(m),w=parseFloat(e.total)+g;if(e.total+=g,_===a.zy){var C=parseFloat(b),T=parseFloat(e.totalCreditAmount)+C;return e.totalCreditAmount+=C,u({acc:e,totalCostOfItems:T,amountRemaining:y,totalAmount:h,bypassLowBalance:!c})}return u({acc:e,totalCostOfItems:w,amountRemaining:y,totalAmount:h,bypassLowBalance:!c})},d)}var v=r||{},m=Object.keys(v).find(e=>Array.isArray(v[e])&&v[e].length),p=m&&(0,i.j6)({subscriptions:v[m]||[]})[0]||{},{totalAmount:f,amountRemaining:h,amountType:y}=(0,i.hY)(p);return{amountType:y,hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:h<=f*a.O7,insufficientAmount:null}}},16319:(e,t,r)=>{r.d(t,{k:()=>i});var a=r(24335),i=()=>{var{checkGate:e}=(0,a.U)();return e("lego-2245-ledger-low-balance")}},26988:(e,t,r)=>{r.d(t,{f:()=>c});var a=r(87011),i=r(93096),n=r(13631),s=r(73923),l=r(98848),u=r(86694),o=r(55729),c=()=>{var{analytics:e}=(0,u.pn)(),{getSearchContext:t}=(0,l.J)(),r=(0,o.useCallback)(t=>{var{cartId:r,items:a}=t,i=(a||[]).map((e,t)=>(0,s.Aj)({asset:e,cartId:r,index:t})),n=i.reduce((e,t)=>({totalPrice:e.totalPrice+Number(t.price),toBeBilled:e.toBeBilled+1}),{totalPrice:0,toBeBilled:0});e.cartViewed({products:i,cartId:r,cartTotal:Math.round(100*n.totalPrice)/100,numItemsBilledToCard:n.toBeBilled,shouldCheckout:n.totalPrice>0,shouldDownload:i.length>0&&0===n.totalPrice})},[e]);return{productAddedAnalyticsEvent:(0,o.useCallback)(r=>{var{cart:a,eventLabel:i,gridItems:n,items:l,licenseId:u,licensePrice:o,listId:c,pageSection:d}=r;e.productAdded({products:l.map(e=>(0,s.Un)({asset:e,cartData:a,getSearchContext:t,gridItems:n,licenseId:u,licensePrice:o,pageSection:d})),eventLabel:i,list_id:null!=c?c:""})},[e,t]),productRemovedAnalyticsEvent:(0,o.useCallback)(r=>{var{cart:l,eventLabel:u,gridItems:o,items:c,listId:d,matchingCartItem:v,pageSection:m}=r;if(v){var[p]=c;e.productRemoved((0,i._)((0,a._)({},(0,s.Un)({asset:p,cartData:l,getSearchContext:t,gridItems:o,pageSection:m})),{price:v.price===n.Mp?0:Number(v.price),variant:v.licenseId,eventLabel:u,list_id:null!=d?d:""}))}else e.productRemoved({products:c.map(e=>(0,s.Un)({asset:e,cartData:l,getSearchContext:t,gridItems:o,pageSection:m})),eventLabel:u,list_id:null!=d?d:""})},[e,t]),cartViewedAnalyticsEvent:r}}},30682:(e,t,r)=>{r.d(t,{b:()=>l,q:()=>s});var a=r(30500),i=r(59044),n=r(48007),s=e=>{var{uniqueSubscription:t}=e;if(!t)return{};var{priceAsAbsolute:r,creditCurrency:s,product:l}=t,u=(0,n.t)({subscription:t}),o=null!=s?s:null==l?void 0:l.currency;if(!r){var{creditPrice:c,creditType:d=a.EV}=t;return{price:"".concat((0,i.YO)({price:c,isUnlimited:u})),priceType:d,currency:o}}var{price:v,priceType:m}=r;return{price:"".concat((0,i.YO)({price:v,isUnlimited:u})),priceType:m,currency:o}},l=e=>{var{uniqueSubscription:t}=e;if(!t)return{};var{currency:r,currencyCost:n}=t;return{price:"".concat((0,i.YO)({price:n,isUnlimited:!1})),priceType:a.EV,currency:r}}},36479:(e,t,r)=>{r.d(t,{Df:()=>p,WP:()=>v,Xl:()=>u,bE:()=>c,bR:()=>h,cb:()=>d,dt:()=>o,fh:()=>f,h_:()=>m,vY:()=>_,vv:()=>y});var a=r(87011),i=r(93096),n=r(14264),s=r(40252),l=e=>{var{urlParams:t={},queryParams:r={}}=e,i="/cart/".concat(t.isPrimary?n.jT:n.pw),l=(0,a._)({},r);return{url:i,defaultParams:l,formattedUrl:(0,s.format)({pathname:i,query:l})}},u=function(){var{urlParams:e={},queryParams:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=l({urlParams:e,queryParams:t}),n=(0,a._)({},r.defaultParams);return(0,i._)((0,a._)({},r),{defaultParams:n,formattedUrl:(0,s.format)({pathname:r.url,query:n})})},o=l,c=l,d=e=>{var{urlParams:t={},queryParams:r={}}=e,i="/cart/".concat(t.fromCartType,"/to/").concat(t.toCartType),n=(0,a._)({},r);return{url:i,defaultParams:n,formattedUrl:(0,s.format)({pathname:i,query:n})}},v=e=>{var{urlParams:t={}}=e,r="/organization/".concat(t.organizationId,"/invitations/").concat(t.status);return{url:r,formattedUrl:(0,s.format)({pathname:r})}},m=e=>{var{urlParams:t={}}=e,r="/account/user/".concat(t.id,"/settings");return{url:r,formattedUrl:(0,s.format)({pathname:r})}},p=e=>{var{urlParams:t={}}=e,r="/account/user/".concat(t.id,"/settings");return{url:r,formattedUrl:(0,s.format)({pathname:r})}},f=e=>{var{urlParams:t={}}=e,r="/organization/".concat(t.organizationId,"/invitations/").concat(t.invitationId);return{url:r,formattedUrl:(0,s.format)({pathname:r})}},h=e=>{var{urlParams:t={}}=e,r="/organization/".concat(t.organizationId,"/invitations");return{url:r,formattedUrl:(0,s.format)({pathname:r})}},y=e=>{var{urlParams:t={}}=e,r="/organization/users/".concat(t.id);return{url:r,formattedUrl:(0,s.format)({pathname:r})}},_=function(){var{queryParams:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="/cart/".concat(n.jT,"/quote"),r=(0,i._)((0,a._)({},e),{exclude_comps:1,expand:"agreements"});return{url:t,defaultParams:r,formattedUrl:(0,s.format)({pathname:t,query:r})}}},36640:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(69185),i=r(21075),n=r(24335),s=()=>{var e,t,r=(0,i.h)(),s=null==r?void 0:r.userCanViewPortfolio,{checkGate:l}=(0,n.U)(),u=l(a.V_),o=null==r||null==(t=r.debugCohorts)||null==(e=t.active)?void 0:e.CohortEnterprisePrePaid;return s||u&&o}},38990:(e,t,r)=>{r.d(t,{O:()=>C});var a=r(87011),i=r(93096),n=r(6029),s=r(87534),l=r(26114),u=r(36997),o=r(58018),c=r(48973),d=r(27326),v=r(15729),m=r(23069),p=r(61266),f=r(68880),h=r(55729),y=r(7703),_=r(50634),b=e=>{var{t,isOpen:r=!1,onClose:a=p.lQ,labelTrack:i}=e,n=(0,_.A)().replace(/-/g,""),s=()=>a(n);return{id:n,alertAction:{label:t("ai_review_process_snackbar:close"),onClick:s},setEntered:()=>{},alertSeverity:c.rD,handleSnackbarClose:s,message:t("ai_review_process_snackbar:text"),labelTrack:i,noAutoHide:!1,isOpen:r}},g=(0,y.n9)()(e=>{var{tokens:{font:t,color:r}}=e;return{linkView:{textDecoration:"underline",fontSize:t.size.s,color:r.white,cursor:"pointer"}}}),w=e=>{var{t}=e,{classes:r}=g();return(0,n.jsx)(s.A,{component:"p",children:(0,n.jsx)(f.x6,{ns:l.PeN,i18nKey:"ai_review_process_snackbar:text",components:{linkView:(0,n.jsx)(o.N,{href:"/catalog/ai-review",linkAs:"/catalog/ai-review",className:r.linkView,"data-automation":"view_ai_review_statuses_link"})},t:t})})},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{isBrandEnterprise:t}=(0,m.P)(),{enqueueSnackbar:r,dequeueSnackbar:s}=(0,v.d)(),{t:o}=(0,f.Bd)(t?l.PeN:""),{isAllowedPages:c}=(0,u.O)(["/generate","/image-generated","/ai-image-generator/history"]),p=t&&c;return(0,h.useCallback)(()=>{var t=b({t:o,labelTrack:d.wju,isOpen:p,onClose:s});setTimeout(()=>{r((0,i._)((0,a._)({},t),{message:(0,n.jsx)(w,{t:o})}))},e)},[e,o,p,s,r])}},43765:(e,t,r)=>{r.d(t,{Y:()=>o});var a=r(87011),i=r(93096),n=r(23069),s=r(81278),l=r(55729),u=r(63896),o=()=>{var e=(0,u.D)(),{isBrandSstk:t}=(0,n.P)(),r=(0,s.useRouter)();return(0,l.useCallback)(()=>{if(t){var n,s;null==(s=window.NREUM)||null==(n=s.addPageAction)||n.call(s,"UP3-1623 assign useCartRedirect cartHref to href",(0,i._)((0,a._)({},window.location||{}),{cartHref:e,isBrandSstk:t})),window.location.href=e}else r.push(e)},[e,t,r])}},62430:(e,t,r)=>{r.d(t,{S:()=>s});var a=r(13631),i=r(95807),n=r(96887),s=e=>{var{assetType:t,subscriptions:r,selectedLicenseId:s}=e;switch(t){case a.G_:return(0,n.K)({licenseName:s,subscriptions:r});case a.FY:case a.on:case a.M9:case a.W1:default:return(0,i.V)({subscriptions:r,licenseName:s})}}},66092:(e,t,r)=>{r.d(t,{_B:()=>et,Ym:()=>ee,ng:()=>ei,Nc:()=>en,_R:()=>er,Fh:()=>ea,tS:()=>es,gz:()=>eu});var a=r(51220),i=r(87011),n=r(93096),s=r(92424),l=r(36479),u=r(87519),o=r(48973),c=r(32598),d=r(38436),v=r(13631),m=r(14264),p=r(45307),f=r(69185),h=r(15261),y=r(30500),_=r(93417),b=r(73923),g=r(16835),w=r(31648),C=r(59044),T=r(44783),I=r(71335),k=r(68958),S=e=>{var{items:t,assetEligibleSubscriptions:r,canShowLedgerLowBalance:a}=e,i={hasInsufficientSubscriptionCredits:!1,hasLowDebitableBalance:!1,insufficientAmount:0,total:0,totalCreditAmount:0,amountType:y.mz};return t.reduce((e,t)=>{var n,{licenseId:s,price:l,id:u}=t,o=null==r||null==(n=r[u])?void 0:n.licenseSubscriptions.find(e=>e.license===s);if(!o)return i;var{totalPrepaidAmount:c,prepaidAmountRemaining:d,currency:v,costType:m}=o,p=parseFloat(l),f=parseFloat(e.total)+p;return e.total+=p,"currency"===m&&f>d&&(e.hasInsufficientSubscriptionCredits=!0,e.hasLowDebitableBalance=!1,e.insufficientAmount=f-d),e.hasLowDebitableBalance=(0,k.I)({canShowLedgerLowBalance:a,hasInsufficientSubscriptionCredits:e.hasInsufficientSubscriptionCredits,units:v,amount:d,initialCommitment:c}),e},i)},A=r(22207),P=r(48007),U=r(85076),q=r(60325),j=r(30682),x=r(57160),E=r(62430),N=r(67666),B=r(16319),D=r(55790),L=r(21075),z=r(38990),O=r(31950),F=r(24335),R=r(93251),V=r(12482),K=r(81278),M=r(55729),Q=r(26988),W=r(98848),Y=r(30721),G="Size limit warning",H=e=>{var t,{item:r,subscriptions:a}=e,{itemType:i,metadata:n}=r,s=(0,C.Q)({asset:r}),l=null==n||null==(t=n.cart)?void 0:t.licenseId,{allSubscriptions:u}=a;switch(i){case v.G_:return(0,x.d)({licenseName:l,subscriptions:u});case v.FY:case v.M9:case v.W1:default:return(0,q.A)({licenseName:l,subscriptions:u,assetType:i,contentTier:s})}},$=e=>{var t,r,{item:a}=e;return(null==(t=a.largeThumb)?void 0:t.url)||(null==(r=a.preview)?void 0:r.url)||a.preview||a.thumb||""},J=e=>{var t,{asset:r}=e;return r.itemType===v.W1&&!r.sizes&&!(null==(t=r.metadata)?void 0:t.cart.sizes)},Z=e=>{var t,r,{item:a}=e,s=(0,C.$9)(a);if(a.itemType===v.m$){var l,u,o,c,m,p,f,h,y,_,b,g=null==a||null==(h=a.product)||null==(f=h.productPreviews[0])||null==(p=f.previewThumbnailImages)?void 0:p.find(e=>{var{resolution:t}=e;return"res600x600"===t}),w={[d.jx]:{height:600,width:600,src:"https://".concat(null==g||null==(y=g.assetFile)?void 0:y.s3Path)}};return{[d.jx]:{height:600,width:600,src:(0,T.c0)((0,n._)((0,i._)({},a),{angle:null==a||null==(b=a.metadata)||null==(_=b.cart)?void 0:_.angle,displays:w}))}}}return s?{[d.pI]:{height:a.height||(null==(t=a.preview)?void 0:t.height),width:a.width||(null==(r=a.preview)?void 0:r.width),src:a.preview||a.thumb}}:{[d.jx]:{height:(null==(l=a.largeThumb)?void 0:l.height)||(null==(u=a.preview)?void 0:u.height),width:(null==(o=a.largeThumb)?void 0:o.width)||(null==(c=a.preview)?void 0:c.width),src:null==(m=a.preview)?void 0:m.url}}},X=e=>{var t,r,a,s,l,u,o,c,m,p,f,y,_,g,w,C,T,I,{item:k,price:S,priceType:A,currency:P,subscriptionId:U,hasCreditsRemaining:q,isUnlimited:j,isUnavailableSubscription:x}=e,E=Z({item:k}),N=$({item:k}).replace("-150nw","-260nw")||(null==E||null==(t=E[d.jx])?void 0:t.src),B=null==(r=k.assets)?void 0:r.find(e=>{var{assetClass:t}=e;return t===h.Iw}),D=[v.m$,v.W1].includes(k.itemType)&&!k.src,L=null==k||null==(o=k.externalSource)||null==(u=o.details)||null==(l=u.pixelsquid)||null==(s=l.product)||null==(a=s.metadata)?void 0:a.isEditorial,z=null==(c=k.meta)?void 0:c.search_context;return(null==(p=k.metadata)||null==(m=p.cart)?void 0:m.searchContext)&&(z=(0,b.fF)({trackingId:null==(w=k.metadata)||null==(g=w.cart)||null==(_=g.searchContext)?void 0:_.searchTrackingId,searchTerm:null==(I=k.metadata)||null==(T=I.cart)||null==(C=T.searchContext)?void 0:C.searchTerm})),(0,i._)((0,n._)((0,i._)((0,n._)((0,i._)({},k),{id:k.itemId}),[v.W1,v.m$,v.uH,v.rr].some(e=>e===k.itemType)&&{image:{id:k.itemId,categories:k.categories,description:k.description||k.subhead||"",url:N,isEditorial:!!k.isEditorial||!!L,isPremium:!!k.isPremium,displays:E,permalink:k.permalink,isIllustration:k.isIllustration,isVector:k.isVector}}),{type:k.itemType,isFootageSelect:k.footageSelect,price:S,priceType:A,waveformPng:k.waveformPng||(null==B?void 0:B.externalUrl),currency:P,licenseId:(null==(y=k.metadata)||null==(f=y.cart)?void 0:f.licenseId)||"",subscriptionId:U,hasCreditsRemaining:q,isPixelSquid:k.itemType===v.m$,isUnavailableAsset:J({asset:k}),isUnlimited:j,isUnavailableSubscription:x,meta:(0,i._)({},z?{search_context:z}:{})}),D&&{src:N})},ee=e=>{var{cartItems:t=[],subscriptions:r}=e;return t.filter(e=>[v.W1,v.m$,v.G_,v.FY,v.M9,v.uH,v.rr].includes(e.itemType)).map(e=>{var t=H({item:e,subscriptions:r}),{price:a=0,priceType:i=y.EV}=(0,j.q)({uniqueSubscription:t});return X({item:e,price:a,priceType:i,currency:(null==t?void 0:t.creditCurrency)||"",subscriptionId:(null==t?void 0:t.id)||"-",isUnavailableSubscription:!t,hasCreditsRemaining:(0,A.X)({subscription:t}),isUnlimited:(0,P.t)({subscription:t})})})},et=e=>{var{isPrimary:t,isLedger:r=!1,isEnterpriseCartEndpointsMigration:a=!1}=e;if(a){var n=t?m.jT:m.pw;return(0,u.yT)((0,i._)({urlParams:{cartType:n}},r&&{queryParams:{isLedger:r}})).formattedUrl}return(0,l.Xl)((0,i._)({urlParams:{isPrimary:t}},r&&{queryParams:{isLedger:r}})).formattedUrl},er=e=>{var{isPrimary:t}=e,r=(0,R.jE)(),s=(0,Y.i9)(),{data:l}=(0,D.R7)(),{checkGate:u}=(0,F.U)(),o=u(f.Kk),c=et({isPrimary:t,isEnterpriseCartEndpointsMigration:o}),d=o?O.Bn:O.C2,{data:v,error:m,isLoading:p}=(0,V.I)({queryKey:[c],enabled:!!(s&&l),queryFn:()=>d.get(c).then(e=>{var{data:t}=e;return t&&(0,n._)((0,i._)({},t),{items:ee({cartItems:t.items,subscriptions:l})})}).catch(e=>{var t,r;throw null==(r=window.NREUM)||null==(t=r.recordCustomEvent)||t.call(r,_.s,{url:c,errorMessage:e.message,errorStack:e.stack}),e})});return{data:v,error:m,isLoading:p,mutate:function(){var e=(0,a._)(function*(e){return e?r.setQueryData([c],e):r.invalidateQueries({queryKey:[c]})});return function(t){return e.apply(this,arguments)}}()}},ea=e=>{var{isPrimary:t}=e,r=(0,R.jE)(),s=(0,Y.i9)(),{checkGate:l}=(0,F.U)(),u=l(f.Kk),o=et({isPrimary:t,isLedger:!0,isEnterpriseCartEndpointsMigration:u}),c=u?O.Bn:O.C2,{data:d}=(0,V.I)({queryKey:[o],enabled:s,queryFn:()=>c.get(o).then(e=>{var{data:t}=e;return t&&(0,n._)((0,i._)({},t),{items:t.items.filter(e=>[v.W1,v.m$,v.G_,v.FY,v.M9,v.uH,v.rr].includes(e.itemType))})}).catch(e=>{var t,r;throw null==(r=window.NREUM)||null==(t=r.recordCustomEvent)||t.call(r,_.s,{url:o,errorMessage:e.message,errorStack:e.stack}),e})});return{data:d,mutate:function(){var e=(0,a._)(function*(e){return e?r.setQueryData([o],e):r.invalidateQueries({queryKey:[o]})});return function(t){return e.apply(this,arguments)}}()}},ei=e=>{var{cartItems:t=[],assetEligibleSubscriptions:r}=e;return t.map(e=>{var t,{id:a,itemType:i,metadata:{cart:{licenseId:n}={}}={}}=null!=e?e:{},s=(0,E.S)({assetType:i,subscriptions:null==r||null==(t=r[a])?void 0:t.licenseSubscriptions,selectedLicenseId:n}),{price:l=0,priceType:u=y.EV}=(0,j.b)({uniqueSubscription:s});return X({item:e,price:l,priceType:u,currency:(null==s?void 0:s.currency)||(null==s?void 0:s.creditCurrency)||"",subscriptionId:(null==s?void 0:s.id)||"-",isUnavailableSubscription:!s,hasCreditsRemaining:!0,isUnlimited:(0,P.t)({subscription:s})})})},en=()=>{var e,t=(0,R.jE)(),[r,s]=(0,M.useState)({status:"",error:void 0}),[d,h]=(0,M.useState)(!1),y=(0,M.useRef)(!1),{checkGate:_}=(0,F.U)(),b=_(f.Kk),{productAddedAnalyticsEvent:C,cartViewedAnalyticsEvent:T,productRemovedAnalyticsEvent:I}=(0,Q.f)(),{getSearchContext:k}=(0,W.J)(),S=(0,K.useRouter)(),A=(0,z.O)(1e3),{queueIpReview:P}=(0,N.F)({trackingId:null==(e=k())?void 0:e.search_tracking_id,onComplete:A}),U=(0,M.useCallback)(e=>{void 0===(null==e?void 0:e.cartId)||y.current||(y.current=!0,T(e))},[y,T]),q=(0,M.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var{id:r}=e;return -1===t.findIndex(e=>{var{id:t}=e;return"".concat(r)==="".concat(t)})})},[]),j=(0,M.useCallback)(e=>{var{cartItems:t=[],itemsToAdd:r=[]}=e,a=[...t];return r.forEach(e=>{var t=(0,w.Qk)({asset:e}),r=a.findIndex(r=>{var{id:a,type:i}=r;return"".concat(a)==="".concat(e.id)&&i===t});r>-1?a[r]=(0,i._)({},e):a.unshift((0,n._)((0,i._)({},e),{addedTime:new Date}))}),a},[]),x=(0,M.useCallback)(function(){var e=(0,a._)(function*(e){var t,{items:r,licenseId:n,licenseAsJpeg:s}=e;return Promise.all(null==r?void 0:r.map((t=(0,a._)(function*(e){var t=(0,w.Qk)({asset:e}),r=n||e.licenseId,a=s||e.licenseAsJpeg,l=yield(0,g.og)({asset:e,licenseName:r});return{item_id:e.id,item_type:t,metadata:{cart:(0,i._)({license_id:r,license_as_jpeg:a,subscription_id:e.subscriptionId,size:l.content_size,format:l.content_format,sizes:(0,g.Rj)({asset:e}),search_context:k(e),source:[v.uH,v.rr].some(e=>e===t)?p.Au:""},t===v.m$&&{angle:l.angle})}}}),function(e){return t.apply(this,arguments)})))});return function(t){return e.apply(this,arguments)}}(),[k]),E=(0,M.useCallback)(function(){var e=(0,a._)(function*(e){var{cart:r,eventLabel:a,gridItems:d,isPrimary:v=!0,itemsToAdd:p,licenseId:f,formatType:y,licensePrice:_,mutateCart:g,withOptimisticUpdate:w=!0,pageSection:T,listId:S}=e;try{var A=p.map(e=>(0,n._)((0,i._)({},e),{meta:(0,i._)({search_context:k(e)},e.meta)}));s({status:"",error:void 0}),h(!1);var U=j({cartItems:r.items,itemsToAdd:A});if(U.length>m.Zm){s({status:o.Nz}),h(!0);return}w&&g(e=>(0,n._)((0,i._)({},e),{items:U}));var q=yield x({items:A,licenseId:f,licenseAsJpeg:y===c.kr});if(b){var E=v?m.jT:m.pw,N=(0,u.AG)({urlParams:{cartType:E}}).formattedUrl;yield O.Bn.post(N,q)}else{var B=(0,l.bE)({urlParams:{isPrimary:v}}).formattedUrl;yield O.C2.post(B,q)}s({status:o.qO}),P(p),v&&A.forEach(e=>{var t=r.items.find(t=>{var{id:r}=t;return"".concat(r)==="".concat(e.id)});t&&f!==t.licenseId&&I({cart:r,eventLabel:a,gridItems:d,items:[e],matchingCartItem:t,pageSection:T}),C({cart:r,eventLabel:a,gridItems:d,items:[e],licenseId:f,licensePrice:_,pageSection:T,listId:S})})}catch(e){s({status:o.Nz,error:e})}finally{yield t.invalidateQueries({queryKey:[et({isPrimary:v,isLedger:!0,isEnterpriseCartEndpointsMigration:b})]}),yield t.invalidateQueries({queryKey:[et({isPrimary:v,isEnterpriseCartEndpointsMigration:b})]})}});return function(t){return e.apply(this,arguments)}}(),[j,x,k,C,I,t,P,b]),B=(0,M.useCallback)(function(){var e=(0,a._)(function*(e){var{cartData:r,eventLabel:a,gridItems:s,isPrimary:o=!0,itemsToRemove:c=[],mutateCart:d,pageSection:v,routePathProps:p,withOptimisticUpdate:f=!0,mutateCallback:h}=e;try{f&&d(e=>(0,n._)((0,i._)({},e),{items:q(e.items,c)}),!1);var y=null,_=null;if(b){var g=o?m.jT:m.pw;_=(0,u.v7)({urlParams:{cartType:g}}).formattedUrl,y=O.Bn}else _=(0,l.dt)({urlParams:{isPrimary:o}}).formattedUrl,y=O.C2;yield y.delete(_,{data:c.map(e=>({item_id:e.id,item_type:(0,w.Qk)({asset:e})}))}),o&&I({cart:r,eventLabel:a,gridItems:s,items:c,pageSection:v}),p&&S.push(...p)}catch(e){}finally{h?h({isPrimary:o}):(yield t.invalidateQueries({queryKey:[et({isPrimary:o,isLedger:!0,isEnterpriseCartEndpointsMigration:b})]}),yield t.invalidateQueries({queryKey:[et({isPrimary:o,isEnterpriseCartEndpointsMigration:b})]}))}});return function(t){return e.apply(this,arguments)}}(),[q,I,S,t,b]);return{triggerCartViewedEvent:U,addCartItems:E,removeCartItems:B,moveToSaveForLater:(0,M.useCallback)(function(){var e=(0,a._)(function*(e){var{eventLabel:t,itemsToMove:r,pageSection:a,primaryCart:c,savedForLaterCart:d,mutatePrimaryCart:v,mutateSavedForLaterCart:p}=e;s({status:"",error:void 0}),h(!1);var f=j({cartItems:d.items,itemsToAdd:r});if(f.length>m.Zm)throw s({status:o.Nz}),h(!0),Error(G);v(e=>(0,n._)((0,i._)({},e),{items:q(e.items,r)}),!1),p(e=>(0,n._)((0,i._)({},e),{items:f}),!1);var y=b?(0,u.jO)({urlParams:{cartType:m.jT,destinationCartType:m.pw}}).formattedUrl:(0,l.cb)({urlParams:{fromCartType:m.jT,toCartType:m.pw}}).formattedUrl,_=yield x({items:r}),g=b?O.Bn:O.C2;yield g.post(y,_),I({cart:c,eventLabel:t,items:r,pageSection:a})});return function(t){return e.apply(this,arguments)}}(),[j,x,I,q,b]),moveToPrimary:(0,M.useCallback)(function(){var e=(0,a._)(function*(e){var{itemsToMove:t,primaryCart:r,mutatePrimaryCart:a,mutateSavedForLaterCart:c}=e;s({status:"",error:void 0}),h(!1);var d=j({cartItems:r.items,itemsToAdd:t});if(d.length>m.Zm)throw s({status:o.Nz}),h(!0),Error(G);c(e=>(0,n._)((0,i._)({},e),{items:q(e.items,t)})),a(e=>(0,n._)((0,i._)({},e),{items:d}));var v=b?(0,u.jO)({urlParams:{cartType:m.pw,destinationCartType:m.jT}}).formattedUrl:(0,l.cb)({urlParams:{fromCartType:m.pw,toCartType:m.jT}}).formattedUrl,p=yield x({items:t}),f=b?O.Bn:O.C2;yield f.post(v,p),C({cart:r,items:t})});return function(t){return e.apply(this,arguments)}}(),[j,x,C,q,b]),addToCartStatus:r,setAddToCartStatus:s,isSizeLimitWarning:d}},es=e=>{var{cartItems:t}=e,{data:r}=(0,D.R7)(),a=(0,L.h)(),{isLoading:i}=a,n=(0,s._)(a,["isLoading"]),l=(e=>{var{items:t}=e;return null==t?void 0:t.some(e=>{var{hasCreditsRemaining:t}=e;return!t})})({items:t}),{amountType:u,hasInsufficientSubscriptionCredits:o,insufficientAmount:c,hasLowDebitableBalance:d}=(0,U.E)({items:t,isLoading:!r||i,subscriptions:r,userCapabilities:n});return{amountType:u,isDebitableUser:(0,I.fY)({userCapabilities:n}),userCanViewDebitableBalance:(0,I.Pl)({userCapabilities:n}),hasInsufficientCartItemsCredits:l,hasInsufficientSubscriptionCredits:o,insufficientAmount:c,hasLowDebitableBalance:d}},el=e=>{var{items:t}=e;return null==t?void 0:t.some(e=>{var{hasCreditsRemaining:t}=e;return!t})},eu=e=>{var{cartItems:t,assetEligibleSubscriptions:r}=e,a=(0,L.h)(),{isLoading:i}=a,n=(0,s._)(a,["isLoading"]),l=(0,B.k)();if(i)return{};var u=el({items:t}),{hasInsufficientSubscriptionCredits:o,insufficientAmount:c,hasLowDebitableBalance:d,amountType:v}=S({items:t,assetEligibleSubscriptions:r,canShowLedgerLowBalance:l})||{};return{amountType:v,isDebitableUser:(0,I.fY)({userCapabilities:n}),userCanViewDebitableBalance:(0,I.Pl)({userCapabilities:n}),hasInsufficientCartItemsCredits:u,hasInsufficientSubscriptionCredits:o,insufficientAmount:c,hasLowDebitableBalance:d}}},67666:(e,t,r)=>{r.d(t,{F:()=>y});var a=r(51220),i=r(87011),n=r(93096),s=r(19640),l=r(22980),u=r(98917),o=r(86380),c=r(23069),d=r(46131),v=r(29862),m=r(91894),p=function(){var e=(0,a._)(function*(e){var{items:t,trackingId:r}=e;0!==t.length&&(yield(0,m.A)("/message-gateway/ip-review",(0,n._)((0,i._)({method:"POST",requireAuth:!0},(0,v.H)({trackingId:r})),{body:{media:t.map(e=>({mediaId:e}))}})))});return function(t){return e.apply(this,arguments)}}(),f=r(93251),h=r(55729),y=function(){var e,{trackingId:t="",updateRequestCache:r,onComplete:v=()=>{}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=(0,d.s)("/"),{isBrandEnterprise:y,brand:_}=(0,c.P)(),b=(0,f.jE)();return{queueIpReview:(0,h.useCallback)((e=(0,a._)(function*(e){if(y){var a,c,d=Array.isArray(e)?e:[e],f=d.reduce((e,t)=>(0,u.iu)(t)?[...e,String(t.id)]:e,[]);if(f.length){var h=(yield b.fetchQuery({queryKey:(0,o.IF)({assetIds:f}),queryFn:e=>{var{queryKey:t}=e;return(0,o.tz)(m,t)}})).reduce((e,t)=>(null==t?void 0:t.isIpReviewed)===!1&&(null==t?void 0:t.ipReviewStatus)!==l.eG?[...e,t]:e,[]);try{if(h.length){yield p({items:h.map(e=>null==e?void 0:e.classicId),trackingId:t});var g=h.map(e=>(b.setQueryData(e.queryKey,[(0,n._)((0,i._)({},e),{isIpReview:!1,ipReviewStatus:l.eG})]),b.invalidateQueries({queryKey:e.queryKey,predicate:t=>{var{queryKey:r}=t;return r===e.queryKey}}))),{formattedRequest:w}=(0,s.Nz)({brand:_,experiments:{},assetId:""}),C=b.invalidateQueries({exact:!1,queryKey:[(0,n._)((0,i._)({},w),{variables:{},headers:{}})],refetchType:"active",predicate:()=>!0});yield Promise.all([...r?[r({reviewStatus:l.eG})]:[],...g,C]),v(d)}}catch(e){null==(c=window.NREUM)||null==(a=c.noticeError)||a.call(c,e,{message:"Error adding assets to queue for IP review: ".concat(h.map(e=>null==e?void 0:e.classicId).join(", "),"\ntrackingId: ").concat(t)})}}}}),function(t){return e.apply(this,arguments)}),[_,y,b,m,t,r,v])}}},68958:(e,t,r)=>{r.d(t,{I:()=>i});var a=r(30500),i=e=>{var{canShowLedgerLowBalance:t,hasInsufficientSubscriptionCredits:r=!1,units:i,amount:n,initialCommitment:s}=e;if(r)return!1;var l=a.Gy[i];return t&&l?Number(n)<=l:Number(n)<=Number(s)*a.O7}},73681:(e,t,r)=>{r.d(t,{z:()=>P,k:()=>U});var a=r(51220),i=r(6029),n=r(66092),s=r(13304),l=r(55729),u=r(87011),o=r(92424),c=r(36640),d=r(71024),v=r.n(d),m=v()(()=>Promise.all([r.e(27510),r.e(72076),r.e(10382),r.e(48417),r.e(77618),r.e(6838),r.e(23100),r.e(26300),r.e(27273)]).then(r.bind(r,95695)).then(e=>({default:e.AddToCartDialog})),{loadableGenerated:{webpack:()=>[95695]},ssr:!1}),p=v()(()=>Promise.all([r.e(27510),r.e(72076),r.e(10382),r.e(48417),r.e(77618),r.e(6838),r.e(23100),r.e(26300),r.e(27273),r.e(49414)]).then(r.bind(r,63882)).then(e=>({default:e.AddToCartDialogLedger})),{loadableGenerated:{webpack:()=>[63882]},ssr:!1}),f=e=>{var{isActive:t}=e,r=(0,o._)(e,["isActive"]),a=(0,s.G)(t),n=(0,c.A)();return a&&(0,i.jsx)(n?p:m,(0,u._)({isActive:t},r))},h=r(93096),y=r(26114),_=r(78586),b=r(70235),g=r(48973),w=r(14264),C=r(43765),T=r(23069),I=r(68880),k=e=>{var{status:t,isSizeLimitWarning:r,alertLabels:a}=e;return r?a.sizeLimitWarning:t===g.qO?a.addToCartSuccess:a.addToCartWarning},S=e=>{var{isOpen:t,isSizeLimitWarning:r=!1,addToCartStatus:a,snackBarActionAllowed:n=!0,handleSnackbarClose:s}=e,{t:l}=(0,I.Bd)(y.evH),{status:o,error:c}=a,d={addToCartSuccess:l("common:actions_added_to_cart"),addToCartWarning:l("notifications:label_add_to_cart_failure"),sizeLimitWarning:l("ent:cart_size_limit_warning",{LIMIT:w.Zm}),viewActionLabel:l("common:actions_view")},v=k({status:o,isSizeLimitWarning:r,alertLabels:d}),{isBrandEnterprise:m}=(0,T.P)(),{viewCartAction:p}=(0,_.Z)(),f=(0,C.Y)(),S={onClick:()=>{s(),m?f():p()},label:d.viewActionLabel};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(b.DynamicSnackbar,(0,h._)((0,u._)({},a.status===g.qO&&n&&{alertAction:S}),{alertSeverity:o,error:c,handleSnackbarClose:s,isOpen:t&&!!o,message:v}))})},A={status:"",error:void 0},P=e=>{var{addToCartStatus:t=A,assets:r=null,eventLabel:a,gridItems:n=null,isAddToCartDialogActive:l,isPrimary:u,isSnackBarOpen:o,isSizeLimitWarning:c,onAddToCart:d,onAlertSnackbarClose:v,setIsAddToCartDialogActive:m,pageSection:p,listId:h,snackBarActionAllowed:y=!0}=e;return(0,s.G)(r)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f,{assets:r,eventLabel:a,gridItems:n,isActive:l,isPrimary:u,listId:h,onAddToCart:d,pageSection:p,setIsActive:m}),(0,i.jsx)(S,{snackBarActionAllowed:y,addToCartStatus:t,handleSnackbarClose:v,isOpen:o,isSizeLimitWarning:c})]}):null},U=function(){var e,t,{withOptimisticUpdate:r=!0,setIsVerifying:i,snackBarActionAllowed:s=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[u,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),[v,m]=(0,l.useState)(null),[p,f]=(0,l.useState)(null),[h,y]=(0,l.useState)(!0),[_,b]=(0,l.useState)(null),[g,w]=(0,l.useState)(null),[C,T]=(0,l.useState)(null),{addCartItems:I,moveToSaveForLater:k,moveToPrimary:S,addToCartStatus:A,isSizeLimitWarning:U,notAddedSelectVideos:q}=(0,n.Nc)();(0,l.useEffect)(()=>()=>m(null),[]);var j=(0,l.useCallback)(e=>{var{assets:t,eventLabel:a,licenseId:n,formatType:s,licensePrice:l,cart:u,mutateCart:o,notAddedSelectVideoIds:c,pageSection:m,listId:f}=e;null==i||i(!0),d(!0),I({cart:u,eventLabel:a,gridItems:p,isPrimary:h,itemsToAdd:t||v,licenseId:n,formatType:s,licensePrice:l,mutateCart:o,notAddedSelectVideoIds:c,withOptimisticUpdate:r,pageSection:m,listId:f})},[v,p,I,h,i,r]),x=(0,l.useCallback)((e=(0,a._)(function*(e){var{itemsToMove:t,primaryCart:r,mutatePrimaryCart:a,mutateSavedForLaterCart:n}=e;null==i||i(!0),d(!0);try{yield S({itemsToMove:t,primaryCart:r,mutatePrimaryCart:a,mutateSavedForLaterCart:n})}catch(e){null==i||i(!1)}}),function(t){return e.apply(this,arguments)}),[S,i]),E=(0,l.useCallback)((t=(0,a._)(function*(e){var{itemsToMove:t,primaryCart:r,savedForLaterCart:a,mutatePrimaryCart:n,mutateSavedForLaterCart:s}=e;null==i||i(!0),d(!0);try{yield k({itemsToMove:t,primaryCart:r,savedForLaterCart:a,mutatePrimaryCart:n,mutateSavedForLaterCart:s})}catch(e){null==i||i(!1)}}),function(e){return t.apply(this,arguments)}),[k,i]);return{addToCartViewsProps:(0,l.useMemo)(()=>({addToCartStatus:A,assets:v,eventLabel:C,gridItems:p,isAddToCartDialogActive:u,isPrimary:h,isSizeLimitWarning:U,isSnackBarOpen:c,onAddToCart:j,onAlertSnackbarClose:()=>d(!1),notAddedSelectVideos:q,setIsAddToCartDialogActive:o,pageSection:_,listId:g,snackBarActionAllowed:s}),[v,p,A,C,g,_,u,h,U,c,q,j,s]),addToCartViewsHandler:(0,l.useCallback)(e=>{var{assets:t,eventLabel:r,gridItems:a,isMoveToPrimaryCart:i=!1,isMoveToSavedForLaterCart:n=!1,isPrimaryCart:s=!0,mutatePrimaryCart:l,mutateSavedForLaterCart:u,primaryCart:c,savedForLaterCart:d,withDialog:v=!0,licenseId:p,licensePrice:h,pageSection:_,listId:g}=e;return(m(t),y(s),b(_),T(r),w(g),a&&f(a),i)?void x({itemsToMove:t,primaryCart:c,mutatePrimaryCart:l,mutateSavedForLaterCart:u}):n?void E({itemsToMove:t,primaryCart:c,savedForLaterCart:d,mutatePrimaryCart:l,mutateSavedForLaterCart:u}):void(v?o(!0):j({assets:t,eventLabel:r,cart:c,licenseId:p,licensePrice:h,mutateCart:l,pageSection:_}))},[j,x,E]),AddToCartViews:P}}},78586:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(27489),i=r(43765),n=r(78042),s=()=>{var e=(0,n.a)(),t=(0,i.Y)(),{openQuickViewCart:r}=(0,a.m)();return{viewCartAction:e?t:r}}},85076:(e,t,r)=>{r.d(t,{E:()=>l});var a=r(30500),i=r(71335),n=r(10545),s=r(3399),l=e=>{var t,{items:r,isLoading:l,subscription:u,subscriptions:o,userCapabilities:c}=e;return l?{}:(u&&(t=u.creditType),o&&o.length>0&&(t=o[0].creditType),(0,i.fY)({userCapabilities:c})?(0,s.h)({items:r,subscription:u,subscriptions:o,hasWrapperSubscription:(0,i.GT)({userCapabilities:c})}):{amountType:t||a.EV,hasLowDebitableBalance:!1,hasInsufficientSubscriptionCredits:u&&0===(0,n.J)({subscription:u}),insufficientAmount:null})}},95807:(e,t,r)=>{r.d(t,{V:()=>a});var a=e=>{var{subscriptions:t,licenseName:r}=e;return null==t?void 0:t.find(e=>e.license===r)}},96887:(e,t,r)=>{r.d(t,{K:()=>l});var a=r(85650),i=r(95807),n=e=>{var t,{licenses:r,subscriptions:a}=e;return r.some(e=>t=(0,i.V)({subscriptions:a,licenseName:e})),t},s=e=>{var{existingAssetLicenses:t,licenseType:r,licenseName:a,subscriptions:i}=e;return a==="footage_".concat(r,"_sd")?n({licenses:(null==t?void 0:t.includes("footage_".concat(r,"_hd")))?["footage_".concat(r,"_hd")]:["footage_".concat(r,"_sd"),"footage_".concat(r,"_hd")],subscriptions:i}):a==="footage_".concat(r,"_lowres")?(null==t?void 0:t.includes("footage_".concat(r,"_hd")))?n({licenses:["footage_".concat(r,"_hd")],subscriptions:i}):(null==t?void 0:t.includes("footage_".concat(r,"_sd")))?n({licenses:["footage_".concat(r,"_sd")],subscriptions:i}):n({licenses:["footage_".concat(r,"_lowres")],subscriptions:i}):void 0},l=e=>{var{existingAssetLicenses:t,subscriptions:r,licenseName:n}=e;if([a.UiI,a.eJJ,a.P2I,a.vWp,a.N8V,a.j35,a.eS$,a.Kwu,a.O_b,a.OSP,a.FO6,a.Fc7].some(e=>e===n)||a.CkD.some(e=>e===n))return(0,i.V)({subscriptions:r,licenseName:n});if([a.eNn,a.AWs,a.H8O,a.GO9].some(e=>e===n))return(0,i.V)({subscriptions:r,licenseName:a.eNn});var l=s({existingAssetLicenses:t,licenseType:a.$Me,licenseName:n,subscriptions:r}),u=s({existingAssetLicenses:t,licenseType:a.Lyy,licenseName:n,subscriptions:r}),o=s({existingAssetLicenses:t,licenseType:a.kTi,licenseName:n,subscriptions:r}),c=s({existingAssetLicenses:t,licenseType:a.IDD,licenseName:n,subscriptions:r});return l||u||o||c||void 0}}}]);
//# sourceMappingURL=73681-4506603e47526948.js.map